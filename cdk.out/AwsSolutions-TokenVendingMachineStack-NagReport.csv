Rule ID,Resource ID,Compliance,Exception Reason,Rule Level,Rule Info
"AwsSolutions-KMS5","TokenVendingMachineStack/TvmSigningKey/Resource","Compliant","N/A","Error","The KMS Symmetric key does not have automatic key rotation enabled."
"AwsSolutions-SMG4","TokenVendingMachineStack/TvmKeySecret/Resource","Suppressed","Rotation not needed for this ephemeral signing secret.","Error","The secret does not have automatic rotation scheduled."
"AwsSolutions-DDB3","TokenVendingMachineStack/TvmEmailAllowlist/Resource","Suppressed","Point-in-time recovery not needed for this simple allowlist","Warning","The DynamoDB table does not have Point-in-time Recovery enabled."
"AwsSolutions-IAM4","TokenVendingMachineStack/TvmLambdaExecRole/Resource","Suppressed","AWSLambdaBasicExecutionRole is required for Lambda logging","Error","The IAM user, role, or group uses AWS managed policies."
"AwsSolutions-IAM5","TokenVendingMachineStack/TvmLambdaExecRole/Resource","Suppressed","KMS permissions are scoped by key.grant() call to avoid circular dependencies","Error","The IAM entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission."
"AwsSolutions-IAM5","TokenVendingMachineStack/TvmLambdaExecRole/DefaultPolicy/Resource","Compliant","N/A","Error","The IAM entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission."
"AwsSolutions-APIG2","TokenVendingMachineStack/TvmApi/Resource","Compliant","N/A","Error","The REST API does not have request validation enabled."
"AwsSolutions-IAM4","TokenVendingMachineStack/TvmApi/CloudWatchRole/Resource","Suppressed","API GW needs AWS-managed log policy for CloudWatch","Error","The IAM user, role, or group uses AWS managed policies."
"AwsSolutions-IAM5","TokenVendingMachineStack/TvmApi/CloudWatchRole/Resource","Compliant","N/A","Error","The IAM entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission."
"AwsSolutions-APIG1","TokenVendingMachineStack/TvmApi/DeploymentStage.prod/Resource","Compliant","N/A","Error","The API does not have access logging enabled."
"AwsSolutions-APIG3","TokenVendingMachineStack/TvmApi/DeploymentStage.prod/Resource","Suppressed","WAF is attached downstream via CfnWebACLAssociation.","Warning","The REST API stage is not associated with AWS WAFv2 web ACL."
"AwsSolutions-APIG6","TokenVendingMachineStack/TvmApi/DeploymentStage.prod/Resource","Compliant","N/A","Error","The REST API Stage does not have CloudWatch logging enabled for all methods."
"AwsSolutions-APIG4","TokenVendingMachineStack/TvmApi/Default/.well-known/openid-configuration/GET/Resource","Suppressed","OIDC Discovery endpoint must be public","Error","The API does not implement authorization."
"AwsSolutions-COG4","TokenVendingMachineStack/TvmApi/Default/.well-known/openid-configuration/GET/Resource","Suppressed","No Cognito auth on discovery","Error","The API GW method does not use a Cognito user pool authorizer."
"AwsSolutions-APIG4","TokenVendingMachineStack/TvmApi/Default/.well-known/jwks.json/GET/Resource","Suppressed","JWKS endpoint must be public","Error","The API does not implement authorization."
"AwsSolutions-COG4","TokenVendingMachineStack/TvmApi/Default/.well-known/jwks.json/GET/Resource","Suppressed","No Cognito auth on JWKS","Error","The API GW method does not use a Cognito user pool authorizer."
"AwsSolutions-APIG4","TokenVendingMachineStack/TvmApi/Default/token/POST/Resource","Suppressed","Token endpoint must be public for OAuth2 clients","Error","The API does not implement authorization."
"AwsSolutions-COG4","TokenVendingMachineStack/TvmApi/Default/token/POST/Resource","Suppressed","No Cognito auth on token","Error","The API GW method does not use a Cognito user pool authorizer."
"AwsSolutions-APIG4","TokenVendingMachineStack/TvmApi/Default/userinfo/GET/Resource","Suppressed","UserInfo endpoint must be public","Error","The API does not implement authorization."
"AwsSolutions-COG4","TokenVendingMachineStack/TvmApi/Default/userinfo/GET/Resource","Suppressed","No Cognito authorizer on UserInfo","Error","The API GW method does not use a Cognito user pool authorizer."
"AwsSolutions-L1","TokenVendingMachineStack/OpenIdConfigurationHandler/Resource","Compliant","N/A","Error","The non-container Lambda function is not configured to use the latest runtime version."
"AwsSolutions-L1","TokenVendingMachineStack/JwksEndpointHandler/Resource","Compliant","N/A","Error","The non-container Lambda function is not configured to use the latest runtime version."
"AwsSolutions-L1","TokenVendingMachineStack/TokenVendingMachineHandler/Resource","Compliant","N/A","Error","The non-container Lambda function is not configured to use the latest runtime version."
