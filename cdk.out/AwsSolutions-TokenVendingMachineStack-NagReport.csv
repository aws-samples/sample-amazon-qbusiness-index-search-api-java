Rule ID,Resource ID,Compliance,Exception Reason,Rule Level,Rule Info
"AwsSolutions-KMS5","TokenVendingMachineStack/TvmSigningKey/Resource","Compliant","N/A","Error","The KMS Symmetric key does not have automatic key rotation enabled."
"AwsSolutions-SMG4","TokenVendingMachineStack/TvmKeySecret/Resource","Suppressed","This secret only stores the KMS key ID for the signing key, not actual key material. The secret contains no sensitive cryptographic data requiring rotation as the KMS service handles all cryptographic operations securely.","Error","The secret does not have automatic rotation scheduled."
"AwsSolutions-DDB3","TokenVendingMachineStack/TvmEmailAllowlist/Resource","Suppressed","Point-in-time recovery is not required for this allowlist table as it stores non-critical configuration data that can be recreated if needed. The table uses RETAIN removal policy to preserve data across deployments.","Warning","The DynamoDB table does not have Point-in-time Recovery enabled."
"AwsSolutions-IAM4","TokenVendingMachineStack/TvmLambdaExecRole/Resource","Suppressed","AWSLambdaBasicExecutionRole is required for Lambda logging and contains the minimal permissions needed for CloudWatch logs. This managed policy is an AWS best practice for Lambda functions.","Error","The IAM user, role, or group uses AWS managed policies."
"AwsSolutions-IAM5","TokenVendingMachineStack/TvmLambdaExecRole/Resource","Suppressed","The wildcard in the KMS policy is necessary to avoid circular dependencies when using key.grant() calls. The actual permissions are properly scoped at runtime to specific key ARNs through the DefaultPolicy and the principle of least privilege is maintained.","Error","The IAM entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission."
"AwsSolutions-IAM5","TokenVendingMachineStack/TvmLambdaExecRole/DefaultPolicy/Resource","Compliant","N/A","Error","The IAM entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission."
"AwsSolutions-APIG2","TokenVendingMachineStack/TvmApi/Resource","Compliant","N/A","Error","The REST API does not have request validation enabled."
"AwsSolutions-IAM4","TokenVendingMachineStack/TvmApi/CloudWatchRole/Resource","Suppressed","API GW needs AWS-managed log policy for CloudWatch","Error","The IAM user, role, or group uses AWS managed policies."
"AwsSolutions-IAM5","TokenVendingMachineStack/TvmApi/CloudWatchRole/Resource","Compliant","N/A","Error","The IAM entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission."
"AwsSolutions-APIG1","TokenVendingMachineStack/TvmApi/DeploymentStage.prod/Resource","Compliant","N/A","Error","The API does not have access logging enabled."
"AwsSolutions-APIG3","TokenVendingMachineStack/TvmApi/DeploymentStage.prod/Resource","Suppressed","The WAF protection is implemented but attached via CfnWebACLAssociation downstream which is not detected by this check. The WebACL implements rate limiting rules to protect against DoS attacks and excessive token requests.","Warning","The REST API stage is not associated with AWS WAFv2 web ACL."
"AwsSolutions-APIG6","TokenVendingMachineStack/TvmApi/DeploymentStage.prod/Resource","Compliant","N/A","Error","The REST API Stage does not have CloudWatch logging enabled for all methods."
"AwsSolutions-APIG4","TokenVendingMachineStack/TvmApi/Default/.well-known/openid-configuration/GET/Resource","Suppressed","The OIDC discovery endpoint must be publicly accessible without authorization as per OpenID Connect specification. This is required for OIDC client discovery and is protected by WAF rate limiting.","Error","The API does not implement authorization."
"AwsSolutions-COG4","TokenVendingMachineStack/TvmApi/Default/.well-known/openid-configuration/GET/Resource","Suppressed","Cognito authorization cannot be used on OIDC discovery endpoints as it would break the OIDC protocol requirements for public metadata access.","Error","The API GW method does not use a Cognito user pool authorizer."
"AwsSolutions-APIG4","TokenVendingMachineStack/TvmApi/Default/.well-known/jwks.json/GET/Resource","Suppressed","The JWKS endpoint must be publicly accessible to provide JWT verification keys. This is a requirement of the OpenID Connect specification and is protected by WAF rate limiting.","Error","The API does not implement authorization."
"AwsSolutions-COG4","TokenVendingMachineStack/TvmApi/Default/.well-known/jwks.json/GET/Resource","Suppressed","Cognito authorization cannot be used on JWKS endpoints as this would prevent OIDC relying parties from validating JWT signatures as required by the protocol.","Error","The API GW method does not use a Cognito user pool authorizer."
"AwsSolutions-APIG4","TokenVendingMachineStack/TvmApi/Default/token/POST/Resource","Suppressed","The token endpoint must be directly accessible to clients to enable the OIDC authorization flow. Email verification and DynamoDB allowlist provide authentication and authorization instead.","Error","The API does not implement authorization."
"AwsSolutions-COG4","TokenVendingMachineStack/TvmApi/Default/token/POST/Resource","Suppressed","Cognito authorization is not applicable as this endpoint implements its own authentication via email verification against the DynamoDB allowlist.","Error","The API GW method does not use a Cognito user pool authorizer."
"AwsSolutions-APIG4","TokenVendingMachineStack/TvmApi/Default/userinfo/GET/Resource","Suppressed","The UserInfo endpoint follows OIDC standards which require it to be accessible by any client with a valid token. Authorization is performed by validating the JWT token in the Authorization header.","Error","The API does not implement authorization."
"AwsSolutions-COG4","TokenVendingMachineStack/TvmApi/Default/userinfo/GET/Resource","Suppressed","Cognito authorization is not applicable as this endpoint implements its own token-based authentication by validating the JWT in the request.","Error","The API GW method does not use a Cognito user pool authorizer."
"AwsSolutions-L1","TokenVendingMachineStack/OpenIdConfigurationHandler/Resource","Compliant","N/A","Error","The non-container Lambda function is not configured to use the latest runtime version."
"AwsSolutions-L1","TokenVendingMachineStack/JwksEndpointHandler/Resource","Compliant","N/A","Error","The non-container Lambda function is not configured to use the latest runtime version."
"AwsSolutions-L1","TokenVendingMachineStack/TokenVendingMachineHandler/Resource","Compliant","N/A","Error","The non-container Lambda function is not configured to use the latest runtime version."
